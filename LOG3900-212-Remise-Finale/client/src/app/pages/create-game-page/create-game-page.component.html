<div [ngClass]="{ 'tutorial-overlay': tutorialTrackerService.isInTutorial }">
    <app-topbar></app-topbar>

    <div class="go-back">
        <i (click)="goBack()" class="fa fa-arrow-left"></i>
    </div>

    <h1>{{ "Création d'une partie" | translate }}</h1>

    <div class="games-container">
        <div class="middle">
            <h3 class="available-title">
                {{ 'Jeux disponibles:' | translate }}
                @if (quizzes.length > 0) {
                <p>{{ currentQuizIndex + 1 }} / {{ quizzes.length }}</p>
                }
            </h3>

            @if (quizzes.length === 0) {
            <ng-container>
                <div class="game-message">{{ 'Aucun jeu disponible.' | translate }}</div>
            </ng-container>
            } @if (quizzes.length > 0) {
            <ng-container>
                <div class="game-details-container">
                    <button
                        class="nav-button left-nav"
                        [ngClass]="{ 'visible-tutorial': tutorialTrackerService.currentStep === 7 }"
                        (click)="previousGame()"
                        [disabled]="currentQuizIndex === 0"
                    >
                        ◀
                    </button>

                    <div class="game-content" [ngClass]="{ 'visible-tutorial': tutorialTrackerService.currentStep === 6 }">
                        <h2>{{ quizzes[currentQuizIndex].title }}</h2>
                        <div class="game-section-one">
                            <div class="description">
                                <label>Description:</label>
                                <label class="game-details">{{ quizzes[currentQuizIndex].description }}</label>
                            </div>
                            <div class="time-allowed">
                                <label>{{ 'Temps alloué:' | translate }}</label>
                                <label class="game-details">{{ quizzes[currentQuizIndex].duration }}</label>
                            </div>
                        </div>

                        <h3 class="question-list-title">{{ 'Liste des questions' | translate }}</h3>
                        <div class="game-section-two">
                            @for (question of quizzes[currentQuizIndex].questions; track question; let index = $index) {
                            <div class="question-container">
                                <label class="question-index">{{ index + 1 }}. </label>
                                <label class="game-details">{{ question.text }} </label>
                                <label class="question-type">({{ question.type }})</label>
                            </div>
                            }
                        </div>
                    </div>

                    <button
                        class="nav-button right-nav"
                        [ngClass]="{ 'visible-tutorial': tutorialTrackerService.currentStep === 7 }"
                        (click)="nextGame()"
                        [disabled]="currentQuizIndex === quizzes.length - 1"
                    >
                        ▶
                    </button>
                </div>
            </ng-container>

            <div class="toggle-container" [ngClass]="{ 'visible-tutorial': tutorialTrackerService.currentStep === 8 }">
                <div class="friends-only-toggle">
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="isFriendsOnly" />
                        <span class="slider"></span>
                    </label>
                    <span class="toggle-label">{{ 'Réservé à mes amis' | translate }}</span>
                </div>
                <div class="price-toggle">
                    <label class="switch">
                        <input type="checkbox" [(ngModel)]="isMoneyGame" />
                        <span class="slider"></span>
                    </label>
                    <span class="toggle-label">{{ "Ajouter un prix d'entrée" | translate }}</span>
                    @if (isMoneyGame) {
                    <input type="number" [(ngModel)]="price" class="price-input" />
                    }
                </div>
            </div>

            <div class="button-container">
                <button class="action" [disabled]="buttonClicked" (click)="onClick()">{{ 'Créer une partie' | translate }}</button>
            </div>
            }
        </div>
    </div>

    @if (tutorialTrackerService.isInTutorial) {
    <div class="tutorial-message">
        @if (tutorialTrackerService.currentStep === 6) {
        <p>{{ 'tuto6' | translate }}</p>
        } @if (tutorialTrackerService.currentStep === 7) {
        <p>{{ 'tuto7' | translate }}</p>
        } @if (tutorialTrackerService.currentStep === 8) {
        <p>{{ 'tuto8' | translate }}</p>
        }
    </div>
    <div class="tutorial-buttons">
        <button (click)="tutorialTrackerService.resetTutorial()">{{ 'tutoClose' | translate }}</button>
        <button (click)="tutorialTrackerService.nextTutorialStep()">{{ 'tutoNext' | translate }}</button>
    </div>
    }
</div>
